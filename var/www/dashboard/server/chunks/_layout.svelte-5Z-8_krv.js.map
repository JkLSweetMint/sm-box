{"version":3,"file":"_layout.svelte-5Z-8_krv.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/_layout.svelte.js"],"sourcesContent":["import { c as create_ssr_component, a as subscribe, s as setContext, v as validate_component, n as noop } from \"../../chunks/ssr.js\";\nimport { r as readable } from \"../../chunks/index.js\";\nimport { R as Root, s as showToast, E as ERROR, C as CHANGE_MAIN_COLOR } from \"../../chunks/Root.js\";\nimport { G as GetText } from \"../../chunks/Text.js\";\nconst WITH_CREDENTIALS = 1;\nconst GetServiceURL = (data) => `/${data.name}/api/v${data.version ?? \"1.0\"}`;\nconst Fetch = async function(data) {\n  data.flags = data.flags ? data.flags : 0;\n  try {\n    let fetchData = {\n      method: data.method ?? \"GET\",\n      credentials: data.flags & WITH_CREDENTIALS ? \"include\" : \"omit\",\n      headers: data.headers\n    };\n    if (fetchData.method != \"GET\") fetchData.body = JSON.stringify(data.data);\n    let query = \"\";\n    if (data.query) query = \"?\" + Object.entries(data.query).map((v) => Array.isArray(v[1]) ? v[1].map((v1) => `${v[0]}=${v1}`) : [`${v[0]}=${v[1]}`]).map((v) => v.join(\"&\")).join(\"&\");\n    const response = await fetch(data.url + query, fetchData);\n    const headers = Object.fromEntries([...response.headers.entries()]);\n    const res = await response.json();\n    return {\n      data: res,\n      meta: {\n        headers\n      }\n    };\n  } catch (err) {\n    throw new Error(`Failed to call a request: ${err}`);\n  }\n};\nconst Layout = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let $services, $$unsubscribe_services;\n  let $dictionary, $$unsubscribe_dictionary = noop, $$subscribe_dictionary = () => ($$unsubscribe_dictionary(), $$unsubscribe_dictionary = subscribe(dictionary, ($$value) => $dictionary = $$value), dictionary);\n  let dictionary = readable();\n  $$subscribe_dictionary();\n  const services = readable({\n    \"auth\": GetServiceURL({ name: \"authentication\" }),\n    \"i18n\": GetServiceURL({ name: \"i18n\" })\n  });\n  $$unsubscribe_services = subscribe(services, (value) => $services = value);\n  setContext(\"services\", services);\n  const callServiceMethod = async function(data) {\n    const errorTitle = GetText(\"dashboard.toasts.error.title\", $dictionary) || \"An error occured\";\n    try {\n      const service = $services[data.service];\n      if (!service) throw new Error(`Failed to call service method: service \"${service}\" is not defined`);\n      let resp = await Fetch({\n        url: `${service}${data.url}`,\n        method: data.method,\n        query: data.query,\n        headers: data.headers,\n        data: data.data,\n        flags: WITH_CREDENTIALS\n      });\n      if (resp.data.code != 200 && data.showToast) {\n        showToast({\n          data: {\n            title: errorTitle,\n            description: `${resp.data.error?.message}`,\n            type: ERROR,\n            flags: CHANGE_MAIN_COLOR\n          }\n        });\n      }\n      resp.data.headers = resp.meta.headers;\n      return resp.data;\n    } catch (error) {\n      if (data.showToast) {\n        showToast({\n          data: {\n            title: errorTitle,\n            description: `${error}`,\n            type: ERROR,\n            flags: CHANGE_MAIN_COLOR\n          }\n        });\n      }\n      return {\n        code: 500,\n        code_message: \"\",\n        status: \"fatal\"\n      };\n    }\n  };\n  setContext(\"CallServiceMethod\", callServiceMethod);\n  const i18nLoadDictionary = async function(path) {\n    let resp = await callServiceMethod({\n      service: \"i18n\",\n      url: \"/texts/dictionary\",\n      query: { paths: path },\n      showToast: true\n    });\n    if (!resp || resp.code != 200) return;\n    return readable(resp.data?.dictionary ?? {});\n  };\n  setContext(\"i18nLoadDictionary\", i18nLoadDictionary);\n  $$unsubscribe_services();\n  $$unsubscribe_dictionary();\n  return `${validate_component(Root, \"Toast\").$$render($$result, {}, {}, {})} ${slots.default ? slots.default({}) : ``}`;\n});\nexport {\n  Layout as default\n};\n"],"names":[],"mappings":"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"}